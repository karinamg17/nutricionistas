{% extends "base.html" %}
{% load static i18n %}
{% load crispy_forms_tags %}

{% block title %}Nutricionistas - Detalle de Pacientes{% endblock %}

{% block title_page %}Pacientes{% endblock title_page %}

{% block css %}

{% endblock css %}

{% block breadcrumb %}
<div class="row page-titles mx-0">
  <div class="col-sm-6 p-md-0">
    <div class="welcome-text">
      <h4>Detalle de Pacientes</h4>
      <p>{{ object.first_name }}, {{object.last_name}}</p>
    </div>
  </div>
  <div class="col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Panel</a></li>
      <li class="breadcrumb-item active"><a href="{% url 'nutri_app:pacientes_list' %}">Listado de usuarios</a></li>
      <li class="breadcrumb-item active"><a href="javascript:void(0)">Detalle</a></li>
    </ol>
  </div>
</div>

{% endblock breadcrumb %}

{% block content %}


<div class="row">
  <div class="col-md-12 text-center">

    {% if not object.foto_usuario %}
    <img src="{% static 'images/user.png' %}" class="img-circle" height="100" width="100" alt="No photo">
    {% else %}
    <img src="{{ user.foto_usuario.thumbnail.140x140 }}" class="img-circle" alt="User photo" />
    {% endif %}
    <br>

  </div>
</div>

<br><br>


<div class="row">
  <div class="col-sm-12">


    <table class="table">

      <thead>
        <tr>
          <th colspan="3">Información geneal</th>
        </tr>
      </thead>

      <tbody>

        <tr>
          <td>Nombres:</td>
          <td>{{ object.first_name }}, {{ object.last_name }} </td>
        </tr>

        <tr>
          <td>Documento:</td>
          <td>{{ object.tipo_docimento }} {{ object.nro_documento }} </td>
        </tr>

        <tr>
          <td>Fecha de nacimiento:</td>
          <td>{{ object.fecha_nacimiento }}. Edad: {{ object.edad }} </td>
        </tr>

        <tr>
          <td>Correo electrónico:</td>
          <td>{{ object.email }} </td>
        </tr>

        <tr>
          <td>Sexo:</td>
          <td>{{ object.sexo }} </td>
        </tr>

      </tbody>
    </table>


    <div class="row">
      <div class="col-xl-12">
        <div class="card">
          <div class="card-header">
            <h4 class="card-title">Expediente</h4>
          </div>
          <div class="card-body">
            <!-- Nav tabs -->
            <div class="default-tab">
              <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item">
                  <a class="nav-link active" data-toggle="tab" href="#home"><i class="la la-home mr-2"></i> Citas</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#profile"><i class="la la-user mr-2"></i> B - C</a>
                </li>
                <!-- <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#contact"><i class="la la-phone mr-2"></i> Valores</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#message"><i class="la la-envelope mr-2"></i> Message</a> -->
                </li>
              </ul>
              <div class="tab-content">
                <div class="tab-pane fade show active" id="home" role="tabpanel">
                  <div class="pt-4">
                    <h4>Citas</h4>

                    <div class="row">
                      <div class="col-md-12 space20">

                        <div class="table-responsive">

                          <table id="table_citas" class="display" style="min-width: 845px">
                            <div class="loading-table-data">
                              <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
                              <span class="sr-only">Download...</span>
                              <p>Download...</p>
                            </div>
                          </table>
                        </div>

                      </div>
                    </div>

                  </div>
                </div>
                <div class="tab-pane fade" id="profile">
                  <div class="pt-4">
                    <h4>Valores</h4>

                    <div class="row">
                      <div class="col-md-12 space20">

                        <div class="table-responsive">

                          <table id="table_valores" class="display" style="min-width: 845px">
                            <div class="loading-table-data">
                              <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
                              <span class="sr-only">Download...</span>
                              <p>Download...</p>
                            </div>
                          </table>
                        </div>

                      </div>
                    </div>

                  </div>
                </div>
                <div class="tab-pane fade" id="contact">
                  <div class="pt-4">
                    <h4>This is contact title</h4>
                    <p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there
                      live the blind texts. Separated they live in Bookmarksgrove.
                    </p>
                    <p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there
                      live the blind texts. Separated they live in Bookmarksgrove.
                    </p>
                  </div>
                </div>
                <div class="tab-pane fade" id="message">
                  <div class="pt-4">
                    <h4>This is message title</h4>
                    <p>Raw denim you probably haven't heard of them jean shorts Austin. Nesciunt tofu stumptown aliqua,
                      retro synth master cleanse. Mustache cliche tempor.
                    </p>
                    <p>Raw denim you probably haven't heard of them jean shorts Austin. Nesciunt tofu stumptown aliqua,
                      retro synth master cleanse. Mustache cliche tempor.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <br>

  </div>
</div>

<input type="hidden" id="user_id" value="{{object.pk}}">

{% endblock content %}


{% block js %}

<script src="{% static 'vendor/moment/moment.min.js' %}"></script>
<script src="{% static 'vendor/datatables/js/jquery.dataTables.min.js' %}"></script>

<script>
  function pacienteDetail(id) {
    var url = "{% url 'nutri_app:pacientes_detail' 999999999 %}";
    document.location.href = url.replace('999999999', id);
  }

  let dTableCitas;

  $(document).ready(
    function () {

      user_id = $("#user_id").val()

      dTableCitas = $('#table_citas').DataTable({

        processing: true,
        serverSide: true,
        lengthChange: false,
        pageLength: 50,
        lengthMenu: [
          [10, 25, -1],
          [10, 25, "All"]
        ],
        'ajax': '/nutri_app/api/paciente_cita/'+user_id+'/?format=datatables',
        columnDefs: [{
          targets: 0,
          render: function (data) {
            return moment(data).format('DD/MM/YYYY');
          }
        }, ],
        'columns': [{
            "title": "Fecha",
            "data": "fecha",
            "responsivePriority": 1,
          },
          {
            "title": "Diagnóstico",
            "data": "diagnostico",
            "responsivePriority": 1,
          },
          {
            "title": "Completada",
            "data": "completada",
            "responsivePriority": 1,
          },
          {
            "data": null,
            "orderable": false,
            "searchable": false,
            "width": "65px",
            "render": function (data, type, row, meta) {

              var a = `<div class="d-flex">
						           <a  class="btn btn-primary shadow btn-xs sharp mr-1"><i class="fa fa-eye"></i></a>
					            </div>`
              return a;
            }
          },

        ],


        "initComplete": function (settings, json) {
          $('div.loading-table-data').hide()
        },

      });


    });

</script>
  
{% endblock js %}
  
